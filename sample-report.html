<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Data Migration Validation Report</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 2rem; color:#111; }
    .card { border: 1px solid #e5e7eb; border-radius: 12px; padding: 1.5rem; max-width: 1100px; }
    h1 { margin: 0 0 0.5rem 0; font-size: 2.2rem; }
    .pill { display:inline-block; background:#f3f4f6; border:1px solid #e5e7eb; padding:.35rem .6rem; border-radius:999px; margin:.2rem .25rem; font-size:.95rem; }
    table { border-collapse: collapse; width: 100%; margin-top: 1rem; }
    th, td { border: 1px solid #e5e7eb; padding: 10px; text-align: left; }
    th { background: #f9fafb; }
    .ok { color: #16a34a; font-weight: 700; }
    .warn { color: #d97706; font-weight: 700; }
    .fail { color: #dc2626; font-weight: 700; }
    .meta { color: #4b5563; margin-top: .25rem; }
    .section { margin-top: 1.25rem; }
    .small { font-size: .9rem; color:#6b7280; }
    a { text-decoration: none; color:#2563eb; }
    details > summary { cursor: pointer; list-style: none; }
    details > summary::-webkit-details-marker { display: none; }
    details > summary::before { content: "▸ "; }
    details[open] > summary::before { content: "▾ "; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Data Migration Validation Report</h1>
    <p class="small">
      Project: Customer master & account migration validation for a telecom client (work performed at Accenture –
      PAN, Aadhaar, DOB, address, plan and status reconciliation between legacy and target systems).
    </p>

    <!-- HEADER PILLS -->
    <div>
      <span class="pill">Primary key: <strong>customer_id</strong></span>
      <span class="pill">Columns: pan_number, aadhaar_number, dob, address, plan_code, status</span>
      <span class="pill">OLD total: <strong>1,200,000</strong></span>
      <span class="pill">NEW total: <strong>1,199,980</strong></span>
      <span class="pill">Only in OLD: <strong>10</strong></span>
      <span class="pill">Only in NEW: <strong>-10 (allowed)</strong></span>
      <span class="pill">Mismatches: <strong>2,350</strong></span>
    </div>

    <!-- HIGH LEVEL CHECKS -->
    <table>
      <thead>
        <tr><th>Check</th><th>Status</th><th>Notes</th></tr>
      </thead>
      <tbody>
        <tr>
          <td>Row count match (after allowlisted adds/deletes)</td>
          <td><span class="ok">PASS</span></td>
          <td>OLD=1,200,000 (adj 1,199,950), NEW=1,199,980 (adj 1,199,950)</td>
        </tr>
        <tr>
          <td>Primary key duplicates (customer_id)</td>
          <td><span class="ok">PASS</span></td>
          <td>OLD dupes=0, NEW dupes=0</td>
        </tr>
        <tr>
          <td>Nulls in required fields (PAN, Aadhaar, DOB)</td>
          <td><span class="ok">PASS</span></td>
          <td>pan_number: OLD=0, NEW=0; aadhaar_number: OLD=0, NEW=0; dob: OLD=0, NEW=0</td>
        </tr>
        <tr>
          <td>Format & length checks (PAN, Aadhaar)</td>
          <td><span class="ok">PASS</span></td>
          <td>All migrated PAN and Aadhaar values meet expected format/length rules</td>
        </tr>
      </tbody>
    </table>

    <!-- TOP MISMATCHES TABLE -->
    <div class="section">
      <h2>Mismatched Cells (first 50)</h2>
      <table class="dataframe">
        <thead>
          <tr>
            <th>customer_id</th>
            <th>column</th>
            <th>old_value</th>
            <th>new_value</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>C00012345</td>
            <td>pan_number</td>
            <td>ABCDE1234F</td>
            <td>ABCDX1234F</td>
          </tr>
          <tr>
            <td>C00056789</td>
            <td>aadhaar_number</td>
            <td>1234-5678-9012</td>
            <td>1234-5678-9013</td>
          </tr>
          <tr>
            <td>C00034567</td>
            <td>dob</td>
            <td>1989-05-14</td>
            <td>1989-04-14</td>
          </tr>
          <tr>
            <td>C00022222</td>
            <td>status</td>
            <td>ACTIVE</td>
            <td>INACTIVE</td>
          </tr>
          <tr>
            <td>C00033333</td>
            <td>plan_code</td>
            <td>PLN_PREPAID_01</td>
            <td>PLN_PREPAID_02</td>
          </tr>
          <tr>
            <td>C00044444</td>
            <td>address</td>
            <td>Old Street 10, Bangalore</td>
            <td>Old St 10, Bengaluru</td>
          </tr>
          <tr>
            <td>C00055555</td>
            <td>plan_code</td>
            <td>PLN_POSTPAID_05</td>
            <td>PLN_POSTPAID_06</td>
          </tr>
          <tr>
            <td>C00066666</td>
            <td>status</td>
            <td>PENDING</td>
            <td>ACTIVE</td>
          </tr>
        </tbody>
      </table>
      <div class="small">
        <a href="output/mismatches.csv">Download full mismatches CSV</a>
      </div>
    </div>

    <!-- PROOFS SECTION -->
    <div class="section">
      <h2>Proofs (inline previews + downloads)</h2>

      <!-- Row counts -->
      <details class="section" open>
        <summary><strong>Row counts (raw & adjusted)</strong> — <a href="output/row_counts.csv">download CSV</a></summary>
        <div style="margin-top:.75rem">
          <table class="dataframe">
            <thead>
              <tr>
                <th>dataset</th>
                <th>raw_count</th>
                <th>allowlisted_ids</th>
                <th>adjusted_count</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>OLD</td>
                <td>1,200,000</td>
                <td>50</td>
                <td>1,199,950</td>
              </tr>
              <tr>
                <td>NEW</td>
                <td>1,199,980</td>
                <td>30</td>
                <td>1,199,950</td>
              </tr>
            </tbody>
          </table>
        </div>
      </details>

      <!-- PK duplicates OLD -->
      <details class="section" open>
        <summary><strong>Primary key duplicates — OLD</strong> <span class="small">0 rows</span> — <a href="output/duplicates_old.csv">download CSV</a></summary>
        <div style="margin-top:.75rem"><em>None</em></div>
      </details>

      <!-- PK duplicates NEW -->
      <details class="section" open>
        <summary><strong>Primary key duplicates — NEW</strong> <span class="small">0 rows</span> — <a href="output/duplicates_new.csv">download CSV</a></summary>
        <div style="margin-top:.75rem"><em>None</em></div>
      </details>

      <!-- Nulls -->
      <details class="section" open>
        <summary><strong>Nulls in required fields</strong> — <a href="output/nulls_summary.csv">download CSV</a></summary>
        <div style="margin-top:.75rem">
          <table class="dataframe">
            <thead>
              <tr>
                <th>field</th>
                <th>old_nulls</th>
                <th>new_nulls</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>pan_number</td>
                <td>0</td>
                <td>0</td>
              </tr>
              <tr>
                <td>aadhaar_number</td>
                <td>0</td>
                <td>0</td>
              </tr>
              <tr>
                <td>dob</td>
                <td>0</td>
                <td>0</td>
              </tr>
            </tbody>
          </table>
        </div>
      </details>

      <!-- Schema comparison -->
      <details class="section" open>
        <summary><strong>Schema comparison</strong> <span class="small">6 columns</span> — <a href="output/schema_comparison.csv">download CSV</a></summary>
        <div style="margin-top:.75rem">
          <table class="dataframe">
            <thead>
              <tr>
                <th>column</th>
                <th>present_in_old</th>
                <th>present_in_new</th>
                <th>dtype_old</th>
                <th>dtype_new</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>customer_id</td>
                <td>True</td>
                <td>True</td>
                <td>varchar(20)</td>
                <td>varchar(20)</td>
              </tr>
              <tr>
                <td>pan_number</td>
                <td>True</td>
                <td>True</td>
                <td>varchar(10)</td>
                <td>varchar(10)</td>
              </tr>
              <tr>
                <td>aadhaar_number</td>
                <td>True</td>
                <td>True</td>
                <td>varchar(14)</td>
                <td>varchar(14)</td>
              </tr>
              <tr>
                <td>dob</td>
                <td>True</td>
                <td>True</td>
                <td>date</td>
                <td>date</td>
              </tr>
              <tr>
                <td>plan_code</td>
                <td>True</td>
                <td>True</td>
                <td>varchar(30)</td>
                <td>varchar(30)</td>
              </tr>
              <tr>
                <td>status</td>
                <td>True</td>
                <td>True</td>
                <td>varchar(10)</td>
                <td>varchar(10)</td>
              </tr>
            </tbody>
          </table>
        </div>
      </details>

      <!-- Only in OLD -->
      <details class="section" open>
        <summary><strong>Only in OLD (unexpected)</strong> — <a href="output/only_in_old.csv">download CSV</a></summary>
        <div style="margin-top:.75rem"><em>None (after removing de-scoped legacy test accounts)</em></div>
      </details>

      <!-- Only in NEW -->
      <details class="section" open>
        <summary><strong>Only in NEW (unexpected)</strong> — <a href="output/only_in_new.csv">download CSV</a></summary>
        <div style="margin-top:.75rem"><em>None (post-cutover activations handled via allowlist)</em></div>
      </details>

      <!-- Detailed mismatches -->
      <details class="section" open>
        <summary><strong>Mismatched Cells</strong> <span class="small">sample of 2,350</span> — <a href="output/mismatches.csv">download CSV</a></summary>
        <div style="margin-top:.75rem">
          <table class="dataframe">
            <thead>
              <tr>
                <th>customer_id</th>
                <th>column</th>
                <th>old_value</th>
                <th>new_value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>C00012345</td>
                <td>pan_number</td>
                <td>ABCDE1234F</td>
                <td>ABCDX1234F</td>
              </tr>
              <tr>
                <td>C00056789</td>
                <td>aadhaar_number</td>
                <td>1234-5678-9012</td>
                <td>1234-5678-9013</td>
              </tr>
              <tr>
                <td>C00034567</td>
                <td>dob</td>
                <td>1989-05-14</td>
                <td>1989-04-14</td>
              </tr>
              <tr>
                <td>C00022222</td>
                <td>status</td>
                <td>ACTIVE</td>
                <td>INACTIVE</td>
              </tr>
              <tr>
                <td>C00033333</td>
                <td>plan_code</td>
                <td>PLN_PREPAID_01</td>
                <td>PLN_PREPAID_02</td>
              </tr>
              <tr>
                <td>C00044444</td>
                <td>address</td>
                <td>Old Street 10, Bangalore</td>
                <td>Old St 10, Bengaluru</td>
              </tr>
            </tbody>
          </table>
        </div>
      </details>
    </div>

    <div class="meta small">
      Exceptions applied — Allowed deletions: legacy test/closed customers (e.g., CTEST001–CTEST010) |
      Allowed additions: new activations post cutover (e.g., CNEW001–CNEW010).
    </div>
  </div>
</body>
</html>
