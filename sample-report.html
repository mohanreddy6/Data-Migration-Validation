<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Data Migration Validation Report</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 2rem; color:#111; }
    .card { border: 1px solid #e5e7eb; border-radius: 12px; padding: 1.5rem; max-width: 1100px; }
    h1 { margin: 0 0 0.5rem 0; font-size: 2.2rem; }
    .pill { display:inline-block; background:#f3f4f6; border:1px solid #e5e7eb; padding:.35rem .6rem; border-radius:999px; margin:.2rem .25rem; font-size:.95rem; }
    table { border-collapse: collapse; width: 100%; margin-top: 1rem; }
    th, td { border: 1px solid #e5e7eb; padding: 10px; text-align: left; }
    th { background: #f9fafb; }
    .ok { color: #16a34a; font-weight: 700; }
    .warn { color: #d97706; font-weight: 700; }
    .fail { color: #dc2626; font-weight: 700; }
    .meta { color: #4b5563; margin-top: .25rem; }
    .section { margin-top: 1.25rem; }
    .small { font-size: .9rem; color:#6b7280; }
    a { text-decoration: none; color:#2563eb; }
    details > summary { cursor: pointer; list-style: none; }
    details > summary::-webkit-details-marker { display: none; }
    details > summary::before { content: "▸ "; }
    details[open] > summary::before { content: "▾ "; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Data Migration Validation Report</h1>
    <p class="small">
      Simple demo: 100 customers migrated from OLD system to NEW system.
      This is a small, easy-to-explain example with basic checks and a few mismatches.
    </p>

    <!-- HEADER PILLS -->
    <div>
      <span class="pill">Primary key: <strong>customer_id</strong></span>
      <span class="pill">Columns: name, email, dob, balance, status</span>
      <span class="pill">OLD total: <strong>100</strong></span>
      <span class="pill">NEW total: <strong>100</strong></span>
      <span class="pill">Only in OLD: <strong>0</strong></span>
      <span class="pill">Only in NEW: <strong>0</strong></span>
      <span class="pill">Mismatches: <strong>5</strong></span>
    </div>

    <!-- HIGH LEVEL CHECKS -->
    <table>
      <thead>
        <tr><th>Check</th><th>Status</th><th>Notes</th></tr>
      </thead>
      <tbody>
        <tr>
          <td>Row count match</td>
          <td><span class="ok">PASS</span></td>
          <td>OLD=100, NEW=100</td>
        </tr>
        <tr>
          <td>Primary key duplicates (customer_id)</td>
          <td><span class="ok">PASS</span></td>
          <td>OLD dupes=0, NEW dupes=0</td>
        </tr>
        <tr>
          <td>Nulls in required fields (name, email)</td>
          <td><span class="ok">PASS</span></td>
          <td>name: OLD=0, NEW=0; email: OLD=0, NEW=0</td>
        </tr>
        <tr>
          <td>Balance type and format</td>
          <td><span class="ok">PASS</span></td>
          <td>All balances are numeric and non-negative</td>
        </tr>
      </tbody>
    </table>

    <!-- TOP MISMATCHES TABLE -->
    <div class="section">
      <h2>Mismatched Cells (5 of 5)</h2>
      <p class="small">
        These examples show where OLD and NEW values are different for the same customer_id.
      </p>
      <table class="dataframe">
        <thead>
          <tr>
            <th>customer_id</th>
            <th>column</th>
            <th>old_value</th>
            <th>new_value</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>C001</td>
            <td>name</td>
            <td>Rahul Kumar</td>
            <td>Rahul K</td>
          </tr>
          <tr>
            <td>C010</td>
            <td>email</td>
            <td>user10@oldmail.com</td>
            <td>user10@newmail.com</td>
          </tr>
          <tr>
            <td>C025</td>
            <td>dob</td>
            <td>1995-03-10</td>
            <td>1995-10-03</td>
          </tr>
          <tr>
            <td>C040</td>
            <td>balance</td>
            <td>1500.00</td>
            <td>1550.00</td>
          </tr>
          <tr>
            <td>C075</td>
            <td>status</td>
            <td>ACTIVE</td>
            <td>INACTIVE</td>
          </tr>
        </tbody>
      </table>
      <div class="small">
        (In a real project, a CSV with all mismatches would be attached here.)
      </div>
    </div>

    <!-- PROOFS SECTION -->
    <div class="section">
      <h2>Proofs (small sample for explanation)</h2>

      <!-- Row counts -->
      <details class="section" open>
        <summary><strong>Row counts</strong></summary>
        <div style="margin-top:.75rem">
          <table class="dataframe">
            <thead>
              <tr>
                <th>dataset</th>
                <th>row_count</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>OLD</td>
                <td>100</td>
              </tr>
              <tr>
                <td>NEW</td>
                <td>100</td>
              </tr>
            </tbody>
          </table>
          <p class="small">
            Explanation: We expect 100 customers in OLD and 100 customers in NEW, and the counts match.
          </p>
        </div>
      </details>

      <!-- Nulls -->
      <details class="section" open>
        <summary><strong>Nulls in required fields</strong></summary>
        <div style="margin-top:.75rem">
          <table class="dataframe">
            <thead>
              <tr>
                <th>field</th>
                <th>old_nulls</th>
                <th>new_nulls</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>name</td>
                <td>0</td>
                <td>0</td>
              </tr>
              <tr>
                <td>email</td>
                <td>0</td>
                <td>0</td>
              </tr>
            </tbody>
          </table>
          <p class="small">
            Explanation: Required columns (name, email) have no missing values in either system.
          </p>
        </div>
      </details>

      <!-- Schema comparison -->
      <details class="section" open>
        <summary><strong>Schema comparison</strong></summary>
        <div style="margin-top:.75rem">
          <table class="dataframe">
            <thead>
              <tr>
                <th>column</th>
                <th>present_in_old</th>
                <th>present_in_new</th>
                <th>dtype_old</th>
                <th>dtype_new</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>customer_id</td>
                <td>True</td>
                <td>True</td>
                <td>string</td>
                <td>string</td>
              </tr>
              <tr>
                <td>name</td>
                <td>True</td>
                <td>True</td>
                <td>string</td>
                <td>string</td>
              </tr>
              <tr>
                <td>email</td>
                <td>True</td>
                <td>True</td>
                <td>string</td>
                <td>string</td>
              </tr>
              <tr>
                <td>dob</td>
                <td>True</td>
                <td>True</td>
                <td>date</td>
                <td>date</td>
              </tr>
              <tr>
                <td>balance</td>
                <td>True</td>
                <td>True</td>
                <td>number</td>
                <td>number</td>
              </tr>
              <tr>
                <td>status</td>
                <td>True</td>
                <td>True</td>
                <td>string</td>
                <td>string</td>
              </tr>
            </tbody>
          </table>
          <p class="small">
            Explanation: All 6 columns exist in both systems, with compatible data types.
          </p>
        </div>
      </details>

      <!-- Only in OLD / NEW -->
      <details class="section" open>
        <summary><strong>Only in OLD / Only in NEW</strong></summary>
        <div style="margin-top:.75rem">
          <p><em>Only in OLD:</em> None (every OLD customer_id exists in NEW).</p>
          <p><em>Only in NEW:</em> None (no extra customer_ids were created).</p>
          <p class="small">
            Explanation: This confirms there is a one-to-one mapping of customers between OLD and NEW.
          </p>
        </div>
      </details>
    </div>

    <div class="meta small">
      Summary: For this simple demo of 100 customers, all structural checks passed.
      Only 5 data value mismatches were found (name, email, dob, balance, status) which would be reviewed with the business.
    </div>
  </div>
</body>
</html>
